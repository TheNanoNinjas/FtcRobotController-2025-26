//2025-26 code for 25756 Nano Ninjas

package org.firstinspires.ftc.teamcode;

import com.qualcomm.robotcore.eventloop.opmode.LinearOpMode;
import com.qualcomm.robotcore.eventloop.opmode.TeleOp;
import com.qualcomm.robotcore.hardware.CRServo;
import com.qualcomm.robotcore.hardware.DcMotor;
import com.qualcomm.robotcore.hardware.Servo;
//import com.qualcomm.robotcore.hardware.DistanceSensor;

//import com.qualcomm.hardware.rev.Rev2mDistanceSensor;


@TeleOp(name = "NanoNinjasMainCode")
public class FTCNanoNinjasCode extends LinearOpMode {

    private DcMotor pushMotor;
    private DcMotor leftShooter;
    private DcMotor rightShooter;
    private DcMotor fl_motor;
    private DcMotor fr_motor;
    private DcMotor bl_motor;
    private DcMotor br_motor;
    //private CRServo rampServo;
    private Servo gateServo;


    @Override
    public void runOpMode() throws InterruptedException {

        initializeHardware();

        waitForStart();

        while (opModeIsActive()) {
            moveRobot();
            shootArtifacts();
            //shootArtifactsTrigger();
            pushArtifacts();
            gateArtifacts();

        }
    }



    private void moveRobot() {
        double drive = -gamepad1.left_stick_y;
        double strafe = -gamepad1.left_stick_x;
        double turn = -gamepad1.right_stick_x;

        double powerScale = 0.40;

        double leftFrontPower = (drive + strafe + turn) * powerScale;
        double rightFrontPower = (drive - strafe - turn) * powerScale;
        double leftRearPower = (drive - strafe + turn) * powerScale;
        double rightRearPower = (drive + strafe - turn) * powerScale;




        double maxPower = Math.max(Math.abs(leftFrontPower),
                Math.max(Math.abs(rightFrontPower),
                        Math.max(Math.abs(leftRearPower), Math.abs(rightRearPower))));
        if (maxPower > 1 ) {
            leftFrontPower /= maxPower;
            rightFrontPower /= maxPower;
            leftRearPower /= maxPower;
            rightRearPower /= maxPower;
        }


        fl_motor.setPower(leftFrontPower);
        fr_motor.setPower(rightFrontPower);
        bl_motor.setPower(leftRearPower);
        br_motor.setPower(rightRearPower);
    }

    private void initializeHardware() {
        leftShooter = hardwareMap.get(DcMotor.class, "leftShooter");
        rightShooter = hardwareMap.get(DcMotor.class, "rightShooter");

        pushMotor = hardwareMap.get(DcMotor.class, "pushMotor");

        //rampServo = hardwareMap.get(CRServo.class, "rampServo");



        fl_motor = hardwareMap.get(DcMotor.class, "fl_motor");
        fr_motor = hardwareMap.get(DcMotor.class, "fr_motor");
        bl_motor = hardwareMap.get(DcMotor.class, "bl_motor");
        br_motor = hardwareMap.get(DcMotor.class, "br_motor");
        gateServo = hardwareMap.get(Servo.class, "gateServo");

        if (leftShooter != null) {
            telemetry.addData("Shoot Motor 1 Initialized on Port :  ", leftShooter.getPortNumber());
        }
        if (rightShooter != null) {
            telemetry.addData("Shoot Motor 2 Initialized on port : ", rightShooter.getPortNumber());
            rightShooter.setDirection(DcMotor.Direction.REVERSE);
        }
        if (pushMotor != null) {
            telemetry.addData("Intake Motor Initialized on port : ", pushMotor.getPortNumber());
        }
        if (gateServo != null) {
            telemetry.addData("Gate Servo Initialized on Port :  ", gateServo.getPortNumber());
        }

        if (fl_motor != null) {
            telemetry.addData("Front Left motor ", "Initialized");
        }
        if (fr_motor != null) {
            telemetry.addData("Front Right motor ", "Initialized");
        }
        if (bl_motor != null) {
            telemetry.addData("Back Left motor ", "Initialized");
        }
        if (br_motor != null) {
            telemetry.addData("Back Right motor ", "Initialized");
        }





        fr_motor.setDirection(DcMotor.Direction.REVERSE);
        bl_motor.setDirection(DcMotor.Direction.REVERSE);


        

        telemetry.addData("Hardware", "Initialized");
        telemetry.update();



    }



    private void shootArtifacts() {
        if (gamepad2.right_bumper) {
            leftShooter.setPower(1.0);
            rightShooter.setPower(1.0);
        } else {
            leftShooter.setPower(0.0);
            rightShooter.setPower(0.0);
        }
    }

    //private void shootArtifactsTrigger() {
       // float factor = 1;
       // float shooting = gamepad2.right_trigger * factor;

        //leftShooter.setPower(shooting);
        //rightShooter.setPower(shooting);
    //}

    private void pushArtifacts() {
        if (gamepad2.left_bumper) {
            pushMotor.setPower(1.0);
        } else {
            pushMotor.setPower(0.0);
        }
    }

    private void gateArtifacts() {
        if (gamepad2.triangle) {
            gateServo.setPosition(0.5);
            telemetry.addData("Gate Servo Position-", gateServo.getPosition());
            telemetry.update();
        }
        else {
         
            gateServo.setPosition(-1.0);
            telemetry.addData("Gate Servo Position-", gateServo.getPosition());
            telemetry.update();
        }
    }


}
